<script src="js/app.min.js"></script>
<script>
	window.URL = window.URL || window.webkitURL;

	const fileSelect = document.getElementById("fileSelect"),
	fileElem = document.getElementById("fileElem"),
	fileList = document.getElementById("fileList"),
	buttonAdd = document.querySelector('.popup__button-add');
	
	if (fileSelect) {
		fileSelect.addEventListener("click", function (e) {
		if (fileElem) {
			fileElem.click();
		}
		e.preventDefault(); // prevent navigation to "#"
		}, false);
	}

	function handleFiles(files) {
		if (!files.length) {
			fileList.innerHTML = "<p>нет выбранных файлов</p>";
		} else if(files.length <= 20){
			fileList.innerHTML = "";
			const container = document.createElement("div");
			container.classList.add('popup__photo-container')
			fileList.insertBefore(container, fileList.childNodes[0]);
			container.appendChild(buttonAdd)
			for (let i = 0; i < files.length; i++) {
				const subContainer = document.createElement("div");
				subContainer.classList.add('popup__photo-img')
				const img = document.createElement("img");
				const imgClose = document.createElement("img");
				subContainer.appendChild(img)
				subContainer.appendChild(imgClose)
				img.src = window.URL.createObjectURL(files[i]);
				img.classList.add('popup__img-review')
				imgClose.classList.add('popup__img-close')
				imgClose.src = '../img/rev-product/rev-photo-add-close.svg'
				img.onload = function() {
				window.URL.revokeObjectURL(this.src);
				}
				container.appendChild(subContainer);
			}
		}
	}

	function handleFilesdoc(files) {
		if (!files.length) {
			fileList.innerHTML = "<p>нет выбранных файлов</p>";
		} else if(files.length === 1){
			fileList.innerHTML = "";
			const container = document.createElement("div");
			container.classList.add('popup__photo-container')
			fileList.insertBefore(container, fileList.childNodes[0]);
			container.appendChild(buttonAdd)
			document.querySelector('.popup__img-add').style.display = 'none';
			for (let i = 0; i < files.length; i++) {
				const subContainer = document.createElement("div");
				subContainer.classList.add('popup__photo-img')
				const img = document.createElement("img");
				const imgClose = document.createElement("img");
				subContainer.appendChild(img)
				subContainer.appendChild(imgClose)
				img.src = window.URL.createObjectURL(files[i]);
				img.classList.add('popup__img-review')
				imgClose.classList.add('popup__img-close')
				imgClose.src = '../img/rev-product/rev-photo-add-close.svg'
				img.onload = function() {
				window.URL.revokeObjectURL(this.src);
				}
				container.appendChild(subContainer);
			}
		}
	}
</script>